![[kafka-1-2083805.png]]

**Apache Kafka** (pull - модель)
	Распределённая и легко маштабируемая система обмена сообщениями с высокой пропускной способностью, которая может в реальном времени обрабатывать любые объёмы данных.


Основные сущности Kafka:

**Broker**
	Один из Брокеров выбирается в качестве контроллера
	Контроллер - координирует работу класса в целом
	У каждой партиции есть свой лидер (брокер-лидер)
	Сообщения пишутся в лидера
	Данные реплицируются между брокерами
	Автоматический фейрловер лидерства 
	Функции:
		- Приём / Хранение / Выдача сообщений consumer-ам

**Zookeeper**
	Распределенный сервис управления конфигурацией и управления (хранит информацию о топиках, партициях, брокерах и обеспечивает согласованность).
	Управляет состоянием (отслеживает и контролирует жизненные циклы и уведомляет остальных об изменении состояния)
	
	База данных (быстро работает на операции чтения)
	Координатор, в котором хранится конфигурация и состояние кластера (**кластер** - множество брокеров)

**Message (Record)**

**Topic / Partition**
	Топик разбит на партиции
	Партиции хранятся на жёстком диске
	Данные удаляются либо времени, либо по размеру (но, их можно хранить вечно)
	Сообщение можно быстро найти по его Offset

**Producer**
	Сервис, который отправляет сообщения

**Consumer**
	Сервис, который получает сообщения
	Возможно объединить в группу несколько костюмеров.


**ISR** (**in-sync replicas**)
	Реплики партиций.
	После записи в лидер-партицию, лидер сразу обращается к этому ISR фолловеру для записи полученного события.
	Таким образом обеспечивается сохранность данных, в случае проблем с лидер-партиции.
	**!!!**

**acks**
	Параметр гарантии доставки сообщения от **Продюсера к Брокеру**
		**0**
			Продюсер не ждёт подтверждение доставки от брокера.
		**1**
			Продюсеру нужно подтверждение только от лидер-реплики.
		**-1** (**all**)
			Продюсер ждет подтверждение не только от лидер-реплики, но и от всех in-sync реплик.




---
Общение микросервисов между собой | Java | Kafka на практике - https://www.youtube.com/watch?v=lxTDkejd6xo
Kafka от теории к практике - https://www.youtube.com/watch?v=ghKnX5fuW5s
Kafka Spring Boot - https://www.youtube.com/watch?v=SqVfCyfCJqw